<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>PON HR Refresh – Germany & Austria • Consumer HR OB Calls</title>
<!-- Chart.js with defer -->
<script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>
<style>
:root{
--primary:#0ea5e9;
--primary-2:#6366f1;
--accent:#10b981;
--danger:#ef4444;
--ink:#0f172a;
--muted:#475569;
--bg:#0b1220;
--page:#0f172a;
--card:#0b1320;
--stroke:#172036;
--soft:#0a1630;
--btn-bg:#0b172e;
--btn-border:#1e293b;
--btn-text:#e2e8f0;
--btn-hover:#10203d;
--btn-shadow: 0 4px 18px rgba(2,6,23,.25);
}
*{box-sizing:border-box}
html,body{height:100%}
html{scroll-behavior:smooth}
body{
font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
margin:0;
color:#e5e7eb;
background:linear-gradient(180deg,var(--bg), #0b1220 30%, #0e1526);
}
header{
background:
radial-gradient(1200px 400px at 20% -10%, rgba(14,165,233,.25), transparent 60%),
radial-gradient(900px 350px at 80% -20%, rgba(99,102,241,.25), transparent 60%),
linear-gradient(180deg, rgba(14,17,40,.75), rgba(8,12,25,.9));
padding: 26px 20px 30px;
position:relative;
overflow:visible;
border-bottom:1px solid #15203a;
}
.brand{display:flex; align-items:center; gap:14px; margin-bottom:10px}
.brand img{width:40px; height:40px; border-radius:10px; background:#fff; object-fit:cover}
h1{margin:0; font-size:30px; letter-spacing:.2px}
header p{margin:6px 0 0; color:#cbd5e1}
.tagbar{display:flex; flex-wrap:wrap; gap:8px; margin-top:12px}
.tag{font-size:12px; padding:4px 10px; border-radius:999px; border:1px solid #1e293b; background:#0a162c; color:#cbd5e1}
.actions{display:flex; flex-wrap:wrap; gap:10px; margin-top:16px; align-items:center}
.button{
appearance:none;
cursor:pointer;
border:1px solid var(--btn-border);
color:var(--btn-text);
background:var(--btn-bg);
padding:10px 14px;
border-radius:10px;
font-weight:700;
backdrop-filter: blur(4px);
box-shadow: var(--btn-shadow);
display:inline-flex;
align-items:center;
gap:10px;
text-decoration:none;
transition:background .18s ease, transform .06s ease, box-shadow .18s ease, border-color .18s ease;
}
.button:hover{background:var(--btn-hover)}
.button:active{transform:translateY(1px)}
.button:focus-visible{
outline:2px solid color-mix(in oklab, var(--primary), white 20%);
outline-offset:2px;
border-color:color-mix(in oklab, var(--primary), black 35%);
box-shadow: 0 0 0 4px rgba(14,165,233,.18);
}
.button--primary{background: linear-gradient(180deg,#0c1b36,#0b172e); border-color:#1f334f;}
.button--ghost{background: transparent; border-color:#24334d;}
.button__icon{width:18px; height:18px; display:inline-block}
/* Dropdown Tools */
.dropdown{ position:relative; }
.dropdown__menu{
position:absolute; top:100%; left:0; min-width:260px;
background: linear-gradient(180deg,#0a1426,#0a1120);
border:1px solid #1f2c3f; border-radius:12px;
box-shadow: 0 14px 30px rgba(2,6,23,.45);
padding:8px; display:none; z-index:20;
}
/* Open on hover or keyboard focus */
.dropdown:hover .dropdown__menu,
.dropdown:focus-within .dropdown__menu { display:block; }
.menu-item{
display:flex; align-items:center; justify-content:space-between; gap:12px;
padding:10px 12px; border-radius:10px; color:#dbe4f0; text-decoration:none; border:1px solid transparent;
}
.menu-item:hover{background:#0f1d36; border-color:#20304c}
.menu-item span{font-size:14px}
.menu-item small{color:#8ea2bd; font-size:12px}
main{padding:22px; max-width:1180px; margin:0 auto}
.section-title{font-size:20px; margin:0 0 10px; color:#e5e7eb}
.card{
background: linear-gradient(180deg,#0a1426,#0a1120);
border:1px solid var(--stroke);
border-radius:14px;
padding:16px 18px;
box-shadow: 0 10px 30px rgba(2,6,23,.25);
margin:14px 0;
}
.card .sub{color:#94a3b8; font-size:13px}
/* KPIs */
.kpis{display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:12px}
.kpi{background: linear-gradient(180deg,#0c1730,#0b152c); border:1px solid #16233d; border-radius:12px; padding:12px}
.kpi .label{font-size:12px; color:#9fb2ca}
.kpi .value{font-size:24px; font-weight:800}
.kpi .note{font-size:12px; color:#93a2b8}
/* Offset for anchor under header */
[data-key-results-anchor]{scroll-margin-top:80px}
.grid-2{display:grid; gap:12px; grid-template-columns:repeat(auto-fit,minmax(300px,1fr))}
.grid-3{display:grid; gap:12px; grid-template-columns:repeat(auto-fit,minmax(260px,1fr))}
.ul-clean{margin:10px 0 0; padding-left:18px}
.ul-clean li{margin:6px 0}
table{width:100%; border-collapse:collapse; margin:6px 0 10px}
th, td{padding:8px 10px; border:1px solid #1e2a44; text-align:left; font-size:13px}
th{background:#0b172e; color:#dbe4f0}
td{color:#cad6e5}
caption{caption-side:top; text-align:left; margin-bottom:6px; color:#a9b8d0; font-size:13px}
.badge{display:inline-block; padding:2px 8px; border-radius:999px; font-size:12px; border:1px solid #1e293b; color:#cbd5e1}
.hr{height:1px; background:linear-gradient(90deg,transparent,#1f2c46,transparent); margin:10px 0}
.pin{font-size:12px; color:#9fb2ca}
.ok{color:#34d399} .warn{color:#f59e0b} .muted{color:#94a3b8}.value.danger{color:var(--danger);}
.footer{font-size:12px; color:#93a2b8; padding: 26px 20px 40px; text-align:center}
@media (max-width: 640px){
.actions{gap:8px}
.button{width:100%; justify-content:center}
h1{font-size:24px}
.dropdown__menu{min-width:100%;}
table{display:block; overflow:auto; white-space:nowrap}
}
</style>
</head>
<body>
<header>
 <div class="brand">
    <img
      src="https://es.wikipedia.org/wiki/American_Express#/media/Archivo:American_Express_logo_(2018).svg"
      alt="American Express logo"
    />
    <div>
      <h1>PON HR Refresh – Germany & Austria • Consumer HR Outbound Calls</h1>
      <p>Outbound calls sub-process to drive KYC refresh, minimize suspensions and avoid cancellations.</p>
    </div>
  </div>
<div class="tagbar" role="list" aria-label="Tags">
<span class="tag">Market: DE & AT</span>
<span class="tag">Segment: Consumer HR</span>
<span class="tag">Maintained by: Germany & Austria Consumer HR KYC Team</span>
<!-- Removed: <span class="tag">OB Calls cadence: every 21 days</span> -->
</div>
<div class="actions" aria-label="Quick actions">
<!-- Performance Highlights (dropdown) -->
<div class="dropdown" id="phDropdown" aria-haspopup="true">
<button type="button" class="button" id="phBtn" aria-controls="phMenu" aria-expanded="false">
Performance Highlights
</button>
<div class="dropdown__menu" id="phMenu" role="menu" aria-label="Performance Highlights">
<!-- Nuevo: Key Details -->
    <a class="menu-item" href="#kpis-sept" role="menuitem" id="linkKeyDetails">
      <span>Key Details</span>
      <small>First block</small>
    </a>
<button type="button" class="menu-item" id="btnStageSept" aria-controls="stage-sept-2024" aria-expanded="false">
<span>Stage Sept 2024</span>
</button>
<button type="button" class="menu-item" id="btnStageMay" aria-controls="stage-may-2025" aria-expanded="false">
<span>Stage May 2025</span>
</button>
<button type="button" class="menu-item" id="btnStageAug" aria-controls="stage-aug-2025" aria-expanded="false">
<span>Stage Aug 2025</span>
</button>
</div>
</div>
<!-- Year-End Results (dropdown) -->
<div class="dropdown" id="yearDropdown" aria-haspopup="true">
<button type="button" class="button" id="yearBtn" aria-controls="yearMenu" aria-expanded="false">
Year-End Results Summary
</button>
<div class="dropdown__menu" id="yearMenu" role="menu" aria-label="Year-End Results">
<button type="button" class="menu-item" id="btnYearOverview" aria-controls="stage-year-end" aria-expanded="false">
<span>Overview 2025</span>
</button>
<div class="hr"></div>
<button type="button" class="menu-item" data-year-period="Q1">
<span>Q1 (Feb-Jun)</span>
</button>
<button type="button" class="menu-item" data-year-period="Q2">
<span>Q2 (Jul-Dec)</span>
</button>
</div>
</div>
</div>
</header>
<main>
<!-- OVERVIEW -->
<section class="card">
<h2 class="section-title">Overview - Outbound Calls HR Strategy</h2>
<div class="grid-2">
<div>
<p class="sub"><b>Workflow Optimization & Oversight</b></p>
<ul class="ul-clean">
<li>Unified data sources - Spend, Tenure, Centurion inventory, HRJ CASES, Credit Active - into a single automated workflow, improving prioritization and reducing manual effort.</li>
<li>Automated validation and quality controls ensuring error-free.</li>
<li>Harmonized processes across markets for consistent execution.</li>
<li>Streamlined retrieval of missing information to reduce cancellations and maintain BAU.</li>
<li>Real-time batch monitoring enabling timely follow-ups and operational accountability.</li>
</ul>
</div>
<div>
<p class="sub"><b>Performance Management</b></p>
<ul class="ul-clean">
<li>SLA-driven weekly cycles with automated reporting on key metrics.</li>
<li>Real-time dashboards providing full visibility to KYC and Concentrix teams.</li>
<li>Defined performance framework with transparent tracking of targets.</li>
</ul>
</div>
</div>
<div class="grid-2">
<div>
<p class="sub"><b>Customer Engagement & Experience Quality</b></p>
<ul class="ul-clean">
<li>Regulatory-aligned scripted flows ensuring clarity and lower escalation rates.</li>
<li>Optimized 21-day outreach cycle improving engagement and completion.</li>
<li>Continuous feedback loop from Concentrix to refine scripts and improve performance.</li>
</ul>
</div>
<div>
<p class="sub"><b>Risk Mitigation & Compliance Strengthening</b></p>
<ul class="ul-clean">
<li>Early identification of at-risk accounts supported by automated alerts.</li>
<li>End-to-end tracking of missing documentation improving audit readiness.</li>
<li>Close alignment with Compliance and KYC for overrides and sensitive cases.</li>
</ul>
</div>
</div>
<div class="grid-2">
<div>
<p class="sub"><b>Cross-Functional Alignment</b></p>
<ul class="ul-clean">
<li>Shared dashboards and standardized reporting enabling fast decision-making across CEN, TLS, Business, MCO.</li>
<li>Close alignment with Compliance and KYC Team for manual overrides and sensitive cases requiring additional due diligence.</li>
<li>Weekly syncs with DE/AT partners to maintain consistency and adjust priorities</li>
</ul>
</div>
</div>
</section>
<!-- KPIs in chronological order: Sept 2024, May 2025, Aug 2025 -->
 <section id="kpis-sept" class="card" data-key-results-anchor>
  <h2 class="section-title">Key Results – September 2024</h2>
  <div class="kpis">
    <div class="kpi">
      <div class="label">AIF YTD</div>
      <div class="value">5,600</div>
      <div class="note">DE: 5k • AT: 0.6k</div>
    </div>
    <div class="kpi">
      <div class="label">% refreshed</div>
      <div class="value danger">56%</div>
      <div class="note">Since 03/2024: BAU</div>
    </div>
    <div class="kpi">
      <div class="label">% in progress</div>
      <div class="value danger">24%</div>
      <div class="note">Active follow-up</div>
    </div>
    <div class="kpi">
      <div class="label">% to be contacted</div>
      <div class="value danger">20%</div>
      <div class="note">DE + AT</div>
    </div>
  </div>
</section>
  <section id="kpis-may" class="card">
    <h2 class="section-title">Key Results – May 2025</h2>
    <div class="kpis">
      <div class="kpi"><div class="label">AIF YTD</div><div class="value">3,700</div><div class="note">DE: 3.2k • AT: 0.5k</div></div>
      <div class="kpi"><div class="label">% refreshed</div><div class="value warn">74%</div><div class="note">18% in progress • 8% to be contacted</div></div>
      <div class="kpi"><div class="label">At risk of cancellation</div><div class="value warn">1.2%</div><div class="note">HR CMs</div></div>
      <div class="kpi"><div class="label">At risk of suspension</div><div class="value warn">1.4%</div><div class="note">Incl. 0.6% Centurion</div></div>
    </div>
  </section>
  <section id="kpis-aug" class="card">
    <h2 class="section-title">Key Results – August 2025</h2>
    <div class="kpis">
      <div class="kpi"><div class="label">AIF YTD</div><div class="value">4,000</div><div class="note">DE: 3.5k • AT: 0.5k</div></div>
      <div class="kpi"><div class="label">% refreshed</div><div class="value ok">85%</div><div class="note">10% in progress • 5% pre-screen</div></div>
      <div class="kpi"><div class="label">Cancellations due to KYC info</div><div class="value ok">≈ 0</div><div class="note">Only 1 exception in HR consumer CM</div></div>
      <div class="kpi"><div class="label">Feedback from HR CMs</div><div class="value ok">Positive</div><div class="note">Willing to complete KYC</div></div>
    </div>
  </section>
<!-- PERFORMANCE CHARTS -->
<section class="card">
<h2 class="section-title">Performance charts</h2>
<div class="grid-3">
<div>
<p class="sub">Refresh rate by month</p>
<canvas id="refreshChart" height="210"></canvas>
<p class="muted pin">Incremental improvement in <b>refresh completion</b> , with steady reductions in in-progress and outreach-required cases.”</p>
</div>
<div>
<p class="sub">AIF YTD by market</p>
<canvas id="aifChart" height="210"></canvas>
<p class="muted pin">Germany drives most of AIF YTD, while Austria remains stable with consistent month-over-month performance.</p>
</div>
<div>
<p class="sub">Suspension vs Inventory</p>
<canvas id="suspChart" height="210"></canvas>
<p class="muted pin">Suspension rate is <b>much lower</b> thanks to a <b>smaller inventory</b> and earlier outreach, reflecting improved portfolio health and proactive case management.</p>
</div>
</div>
</section>
<!-- STAGE SEPT 2024 -->
<section id="stage-sept-2024" class="card" style="display:none">
<h2 class="section-title">PON HR Refresh – September 2024 status</h2>
<p class="sub">Key Facts</p>
<ul class="ul-clean li-emoji">
<li>High Risk portfolio: approx. 5.600 AIF YTD (DE: 5k / AT: 0,6k)</li>
<li>120-day KYC HR Refresh journey with risk of cancellation if account not fully refreshed</li>
<li>Since 04/2024: BAU. 56% refreshed, 24% in progress, 20% to be contacted</li>
</ul>
<table>
  <caption>HR Consumer Refresh – Sep. 2024</caption>
  <thead>
    <tr>
      <th>Stage</th>
      <th>HR Consumer Refresh</th>
      <th>HR CM volume</th>
      <th>HR CM refreshed</th>
      <th>CMs currently suspended</th>
      <th>HR CM KYC cancelled</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <!-- Stage: un solo rótulo que cubre todas las filas -->
      <td rowspan="3">Sep. 2024</td>
      <th scope="row">Austria</th>
      <td>575</td>
      <td>365</td>
      <td>14</td>
      <td>14</td>
    </tr>
    <tr>
      <th scope="row">Germany</th>
      <td>5.070</td>
      <td>2.823</td>
      <td>217</td>
      <td>113</td>
    </tr>
    <tr>
      <th scope="row">Overall</th>
      <td>5.645</td>
      <td>3.188</td>
      <td>231</td>
      <td>127</td>
    </tr>
  </tbody>
</table>
<button class="button" id="csvSeptConsumerBtn">Download CSV</button>
<table>
  <caption>HR Centurion – Sep. 2024</caption>
  <thead>
    <tr>
      <th>Stage</th>
      <th>Centurion</th>
      <th>HR Centurion volume</th>
      <th>Centurion refreshed</th>
      <th>Centurion suspended</th>
      <th>Centurion KYC cancelled</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <!-- Stage: un solo rótulo que cubre todas las filas -->
      <td rowspan="3">Sep. 2024</td>
      <th scope="row">Austria</th>
      <td>130</td>
      <td>90</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th scope="row">Germany</th>
      <td>385</td>
      <td>241</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th scope="row">Overall</th>
      <td>515</td>
      <td>331</td>
      <td>5</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
<button class="button" id="csvSeptCenturionBtn">Download CSV</button>
<div class="grid-2" style="margin-top:10px">
<div>
<p class="sub"><b>HR Consumer</b> VS status by Market</p>
<canvas id="septConsumerChart" height="220"></canvas>
</div>
<div>
<p class="sub"><b>HR Centurion</b> VS status by Market</p>
<canvas id="septCenturionChart" height="220"></canvas>
</div>
</div>
 <div class="notes" style="margin-top:12px">
      <p>4% HR CMs in suspension are in risk of cancellation: (14 AT / 217 DE)<br>
      * incl 5 Centurion CMs (2 AT / 3 DE)</p>
      <p>5.5% HR CMs are in risk of suspension (25 AT / 287 DE)<br>
      * incl. 9 Centurion (3 AT / 6 DE)</p>
      <h3 class="sub" style="margin-top:8px">CURRENT RISK &amp; CHALLENGES</h3>
      <p>&gt; We observe an increased number of voluntary attrition amongst HR base.
  * Next steps: analyze of data to understand trigger and whether potential remediation<br>
      <h3 class="sub" style="margin-top:8px">SUPPORT NEEDED</h3>
 &gt; Linkage of basic and supp cancellation:<br>
      * Leadership support needed for interim remediation until HR Partial Canx is implemented</p>
      <h3 class="sub" style="margin-top:8px">PROCESS ENHANCEMENTS</h3>
  <p>OB Calls | initiated mid-June, outbound calls to HR CM at risk of cancellation and at risk of suspension are ongoing. First results, positive. 1/3 CM contacted with promise to action.</p>
      <p>Enhancement of CM journey &amp; backend process: HR form uplifted to include only mandatory data. dropdown selection included whenever possible to simplifies backend process<br>
      &gt; DocUpload login correction without CM15: in working progress</p>
    </div>
  </section>
<!-- STAGE MAY 2025 -->
<section id="stage-may-2025" class="card" style="display:none">
<h2 class="section-title">PON HR Refresh – May 2025 status</h2>
<p class="sub">Key Facts</p>
<ul class="ul-clean li-emoji">
<li>KYC HR cons process is in BAU since 04/2024. Refresh journey of 120-day with account cancellation if basic not fully refreshed</li>
<li>3,700 AIF YTD (DE: 3.2k / AT: 0.5k) HR Cons</li>
<li>74% refreshed, 18% in progress, 8% to be contacted - HR Consumer</li>
</ul>
<table>
  <caption>HR Consumer – Mai. 2025</caption>
  <thead>
    <tr>
      <th>Stage</th>
      <th>HR Consumer Refresh</th>
      <th>HR CM volume</th>
      <th>HR CM refreshed</th>
      <th>CMs currently suspended</th>
      <th>HR CM KYC cancelled</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td rowspan="3">May. 2025</td>
      <th scope="row">Austria</th>
      <td>480</td>
      <td>318</td>
      <td>11</td>
      <td>0</td>
    </tr>
    <tr>
      <th scope="row">Germany</th>
      <td>3,216</td>
      <td>2,612</td>
      <td>33</td>
      <td>0</td>
    </tr>
    <tr>
      <th scope="row">Overall</th>
      <td>3,696</td>
      <td>2,930</td>
      <td>44</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<button class="button" id="csvMayConsumerBtn">Download CSV</button>
<table>
  <caption>HR Centurion – May. 2025</caption>
  <thead>
    <tr>
      <th>Stage</th>
      <th>Centurion</th>
      <th>HR Centurion volume</th>
      <th>Centurion refreshed</th>
      <th>Centurion suspended</th>
      <th>Centurion cancelled</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td rowspan="3">Mai. 2025</td>
      <th scope="row">Austria</th>
      <td>101</td>
      <td>59</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th scope="row">Germany</th>
      <td>399</td>
      <td>299</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th scope="row">Overall</th>
      <td>500</td>
      <td>358</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<button class="button" id="csvMayCenturionBtn">Download CSV</button>
<div class="grid-2" style="margin-top:10px">
<div>
<p class="sub">HR Consumer table → chart</p>
<canvas id="mayConsumerChart" height="220"></canvas>
</div>
<div>
<p class="sub">HR Centurion table → chart</p>
<canvas id="mayCenturionChart" height="220"></canvas>
</div>
</div>
<div class="notes" style="margin-top:12px">
      <p>1.2% HR CMs are in risk of cancellation: (11 AT / 33 DE)<br>
      * No Centurion CMs are currently at risk of cancellation<br>
      1.4% HR CMs are in risk of suspension (18 AT / 35 DE)<br>
      * Incl. 0.6% Centurion (1 AT / 2 DE)</p>
      <h3 class="sub" style="margin-top:8px">ENHANCEMENTS PERFORMED SINCE JAN 2025</h3>
      <p>Strategic OB Calls to selected customer indicates excellent outcome in overall results and savings of high spender customers:<br>
         &gt; We’ve refined the OB Calls recipient data &amp; enriched with relevant details for a better customer experience and effectiveness<br>
         &gt; Similar strategy has been engaged toward our premium base via the Portfolio Manager POC<br>
      Robust process implemented to save basic if account is partially refreshed with required documentation in place since 03/25<br>
      Process adjusted in context of HR consumer becoming HR Jurisdiction case during refresh: journey is extended with 30 days extra &amp; CM receives GSG OB calls to be informed of additional SOW requirement<br>
      KYC comms is updated with new ‘Güterplatz’ address which allows no further delay in KYC process path</p>
    </div>
  </section>
<!-- STAGE AUG 2025 -->
<section id="stage-aug-2025" class="card" style="display:none">
<h2 class="section-title">PON HR Refresh – August 2025 status</h2>
<p class="sub">Key Facts</p>
<ul class="ul-clean li-emoji">
<li>KYC HR cons process works automated, with targeted manual workarounds when specifies are required (e.g. partial refresh, HR becoming hrj).</li>
<li>HR Refresh journey contains 120-day with account cancellation if basic not fully refreshed. Suspension marked at Day 60 DE/AT.</li>
<li>4K AIF Y TD (DE: 3,5k/AT: 0,5k) HR Cons.</li>
<li>85% HR Consumer refreshed, 10% in progress, 5% in pre-screening to be contacted.</li>
</ul>
<table>
  <caption>HR Consumer Refresh – Aug. 2025</caption>
  <thead>
    <tr>
      <th>Stage</th>
      <th>HR Consumer Refresh</th>
      <th>HR CM volume</th>
      <th>HR CM refreshed</th>
      <th>CMs currently suspended</th>
      <th>HR CM KYC cancelled</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td rowspan="3">Aug. 2025</td>
      <th scope="row">Austria</th>
      <td>515</td>
      <td>377</td>
      <td>18</td>
      <td>0</td>
    </tr>
    <tr>
      <th scope="row">Germany</th>
      <td>3,573</td>
      <td>3,108</td>
      <td>59</td>
      <td>1</td>
    </tr>
    <tr>
      <th scope="row">Overall</th>
      <td>4,088</td>
      <td>3,485</td>
      <td>77</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<button class="button" id="csvAugConsumerBtn">Download CSV</button>
<table>
  <caption>HR Centurion – Aug. 2025</caption>
  <thead>
    <tr>
      <th>Stage</th>
      <th>Centurion</th>
      <th>Centurion volume</th>
      <th>Centurion refreshed</th>
      <th>Centurion suspended</th>
      <th>Centurion cancelled</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td rowspan="3">Aug. 2025</td>
      <th scope="row">Austria</th>
      <td>114</td>
      <td>72</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th scope="row">Germany</th>
      <td>465</td>
      <td>400</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th scope="row">Overall</th>
      <td>579</td>
      <td>472</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<button class="button" id="csvAugCenturionBtn">Download CSV</button>
<div class="grid-2" style="margin-top:10px">
<div>
<p class="sub">HR Consumer table → chart</p>
<canvas id="augConsumerChart" height="220"></canvas>
</div>
<div>
<p class="sub">HR Centurion table → chart</p>
<canvas id="augCenturionChart" height="220"></canvas>
</div>
</div>
 <div class="notes" style="margin-top:16px">
  <h3 class="sub">ENHANCEMENTS PERFORMED SINCE JAN 2025</h3>
  <p>Strategic Out-Bound (OB) Calls to selected customer: HR CM are refreshed mostly prior suspension, allowing CM to continue to spend and enjoy higher customer satisfaction<br>
  Similar strategy is applied toward our premium base via the Portfolio Manager POC for outstanding results<br>
  Robust process implemented to save basic status if account is partially refreshed with required documentation in place since 03/25<br>
  Process adjusted in context of HR consumer becoming High Risk Jurisdiction during KYC refresh: journey is extended with 30 days extra and CM receives GSG OB calls to be informed of additional SOW requirement<br>
  Overall: KYC HR process is running smoothly</p>
</div>
 </div>
</section>
<section id="stage-year-end" class="card" style="display:none">
<h2 class="section-title">Year-End Results Summary <span class="muted" id="yearContextLabel">• Overview 2025</span></h2>
<p class="sub">2025 Results</p>
<table id="yearTable" style="display:none !important; visibility:hidden; opacity:0; height:0; overflow:hidden;">
<caption id="yearTableCaption">Outbound Calls — Overview 2025</caption>
<thead>
<tr>
<th>Lote</th>
<th>Total Contact</th>
<th>Germany</th>
<th>Austria</th>
<th>Credit active, card cancelled</th>
<th>Successful - incl. Calls, forwarded for link, promised to do it</th>
<th>Not successful - no answer, left message</th>
<th>Other – (does not want to do the refresh </th>
<th>Success rate OB %</th>
<th>Success rate by month %</th>
</tr>
</thead>
<tbody id="yearTableBody"></tbody>
</table>
<h3 class="sub">Year-End 2025 Highlights</h3>
<ul class="ul-clean">
<li>Continuous weekly outbound campaigns from Feb-Nov 2025
<ul class="ul-clean">
<li>Success rates improved month-over-month
<ul class="ul-clean">
<li>Early months (Feb-Mar): 36-41%</li>
<li>Mid-year (Jun-Jul): 65-70%</li>
<li>End-year (Oct-Nov): stabilized at 63-73%</li>
</ul>
</li>
</ul>
</li>
<li>Average success rate by month: 60-65%</li>
<li>Most outreach successfully completed before suspension deadlines</li>
</ul>
<h3 class="sub">Key Benefits:</h3>
<ul class="ul-clean">
<li>Operational Efficiency: Unified workflow reduces manual intervention and errors.</li>
<li>Customer Retention: Early proactive outreach prevents cancellations and suspensions</li>
<li>Compliance Strengthening: Full traceability and documentation readiness.</li>
<li>Cross-Functional Transparency: Shared dashboards improve collaboration between business, compliance and Concentrix</li>
<li>Improved Customer Experience: Scripted, Compliant, and clear outbound communication increased customer trust and responsiveness</li>
</ul>
<h3 class="sub">Next Steps:</h3>
<ul class="ul-clean">
<li>Integrate outbound call design directly into IRefresh platform (by KYC team_cons HR DE/AT)</li>
<li>Retrieve and streamline AT suspension processes</li>
<li>Prepare for 2027 regulatory requirements (mandatory SOW/SOF documentation for full HR base)</li>
</ul>
<h3 class="sub">Overall Outcome:</h3>
<p>-The PON HR Refresh project demonstrates a highly successful transformation of the KYC HR Consumer process in Germany and Austria - achieving automation, compliance, and customer satisfaction goals, with sustained year-over-year improvement and virtually zero cancellations by mid-2025</p>
<div style="margin-top:14px">
<p class="sub"><b>Visualisation</b> • Volume VS performance</p>
<canvas id="yearChart" height="260"></canvas>
<div class="actions" style="margin-top:8px">
<button class="button" id="csvYearBtn">Download CSV</button>
</div>
</div>
<div style="margin-top:18px">
<p class="sub"><b>Monthly Resume</b> • Successful per month + % Success Monthly</p>
<canvas id="yearChartMonthly" height="240"></canvas>
<div class="actions" style="margin-top:6px">
<button class="button" id="csvYearMonthlyBtn">Download CSV (Monthly)</button>
</div>
</div>
<div style="margin-top:18px">
<p class="sub"><b>Germany vs Austria</b> • Volume per market (Monthly)</p>
<canvas id="yearChartGA" height="240"></canvas>
<div class="actions" style="margin-top:6px">
<button class="button" id="csvYearGABtn">Download CSV</button>
</div>
</div>
</section>
</main>
<div class="footer">
Maintained by Germany & Austria Consumer HR • Outbound Calls program
</div>
<script>
window.addEventListener('DOMContentLoaded', () => {
/* Tools dropdown eliminado */
/* Show/Hide Stages */
const sSept = document.getElementById('stage-sept-2024');
const sMay = document.getElementById('stage-may-2025');
const sAug = document.getElementById('stage-aug-2025');
const bSept = document.getElementById('btnStageSept');
const bMay = document.getElementById('btnStageMay');
const bAug = document.getElementById('btnStageAug');
function hideAllStages(){
[sSept, sMay, sAug].forEach(sec => { if (sec) sec.style.display = 'none'; });
[bSept, bMay, bAug].forEach(b => { if (b) b.setAttribute('aria-expanded','false'); });
}
function toggleStage(sectionEl, buttonEl){
const willOpen = sectionEl.style.display === 'none';
hideAllStages();
sectionEl.style.display = willOpen ? '' : 'none';
buttonEl.setAttribute('aria-expanded', String(willOpen));
if (willOpen) window.scrollTo({ top: sectionEl.offsetTop - 16, behavior: 'smooth' });
}
hideAllStages();
bSept?.addEventListener('click', () => toggleStage(sSept, bSept));
bMay?.addEventListener('click', () => toggleStage(sMay, bMay));
bAug?.addEventListener('click', () => toggleStage(sAug, bAug));
/* Charts palette */
const css = getComputedStyle(document.documentElement);
const cIndigo = css.getPropertyValue('--primary-2').trim() || '#6366f1';
const cSky = css.getPropertyValue('--primary').trim() || '#0ea5e9';
const cEmerald = css.getPropertyValue('--accent').trim() || '#10b981';
const cMuted = '#94a3b8';
const axisColor = () => '#a8b1c7';
const gridColor = (light=0.12) => `rgba(148,163,184,${light})`;
/* CSV utility */
function downloadCSV(filename, rows){
const process = (v) => {
if (v === null || v === undefined) return '';
const s = String(v).replace(/"/g,'""');
return `"${s}"`;
};
const csv = rows.map(r => r.map(process).join(',')).join('\n');
const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
const url = URL.createObjectURL(blob);
const a = document.createElement('a');
a.href = url; a.download = filename;
document.body.appendChild(a); a.click();
document.body.removeChild(a);
URL.revokeObjectURL(url);
}
/* Export visible datasets of a Chart.js chart */
function exportChartToCSV(chart, filename){
if (!chart) return;
const labels = chart.data.labels || [];
const visible = chart.data.datasets
.map((ds, i) => ({ ds, i, meta: chart.getDatasetMeta(i) }))
.filter(({ meta }) => !meta.hidden);
const header = [''].concat(visible.map(({ ds }) => ds.label || 'Series'));
const rows = [header];
labels.forEach((label, rowIdx) => {
const row = [label];
visible.forEach(({ ds }) => {
const v = Array.isArray(ds.data) ? ds.data[rowIdx] : '';
row.push(v ?? '');
});
rows.push(row);
});
downloadCSV(filename, rows);
}
/* Fallback: export HTML table to CSV */
function exportTableToCSV(tableEl, filename){
if (!tableEl) return;
const rows = [];
const trsHead = tableEl.querySelectorAll('thead tr');
trsHead.forEach(tr => rows.push([...tr.cells].map(td => td.innerText.trim())));
const trsBody = tableEl.querySelectorAll('tbody tr');
trsBody.forEach(tr => rows.push([...tr.cells].map(td => td.innerText.trim())));
downloadCSV(filename, rows);
}
/* Main charts */
const refreshEl = document.getElementById('refreshChart');
const aifEl = document.getElementById('aifChart');
const suspEl = document.getElementById('suspChart');
const chartRefresh = refreshEl && window.Chart ? new Chart(refreshEl, {
type:'line',
data:{
labels:['May 2025','Jun 2025','Jul 2025','Aug 2025','Sep 2025'],
datasets:[
{ label:'% Refreshed', data:[74,79,82,85,88], borderColor:cIndigo, backgroundColor:'rgba(99,102,241,.18)', fill:true, tension:.35, borderWidth:3, pointRadius:2 },
{ label:'% In progress', data:[18,15,13,10,8], borderColor:cSky, backgroundColor:'rgba(14,165,233,.15)', fill:true, tension:.35, borderWidth:2, pointRadius:2 },
{ label:'% To contact / Pre-screen', data:[8,6,5,5,4], borderColor:cMuted, backgroundColor:'rgba(148,163,184,.12)', fill:true, tension:.35, borderWidth:2 }
]
},
options:{
plugins:{ legend:{ position:'bottom', labels:{ color:'#cbd5e1' } } },
scales:{ x:{ ticks:{ color:axisColor() }, grid:{ color:gridColor(.15) } },
y:{ ticks:{ color:axisColor(), callback:v=>v+'%' }, grid:{ color:gridColor(.12) } } }
}
}) : null;
const chartAIF = aifEl && window.Chart ? new Chart(aifEl, {
type:'bar',
data:{
labels:['Germany','Austria'],
datasets:[
{ label:'AIF YTD (May)', data:[3200,500], backgroundColor:'rgba(14,165,233,.65)', borderColor:cSky, borderWidth:1 },
{ label:'AIF YTD (Aug)', data:[3500,500], backgroundColor:'rgba(16,185,129,.65)', borderColor:cEmerald, borderWidth:1 },
{ label:'AIF YTD (Sep)', data:[3600,500], backgroundColor:'rgba(99,102,241,.65)', borderColor:cIndigo, borderWidth:1 }
]
},
options:{
plugins:{ legend:{ position:'bottom', labels:{ color:'#cbd5e1' } } },
scales:{ x:{ ticks:{ color:axisColor() }, grid:{ color:gridColor(.15) } },
y:{ beginAtZero:true, ticks:{ color:axisColor(), callback:v=>Number(v).toLocaleString() }, grid:{ color:gridColor(.12) } } }
}
}) : null;
const chartSusp = suspEl && window.Chart ? new Chart(suspEl, {
type:'line',
data:{
labels:['May','Jun','Jul','Aug','Sep'],
datasets:[
{ label:'Open inventory (index)', data:[100,75,60,45,30], yAxisID:'y2', borderDash:[6,4], borderColor:cMuted, backgroundColor:'transparent', tension:.35, borderWidth:2 },
{ label:'Suspension rate %', data:[1.4,1.1,0.9,0.6,0.4], yAxisID:'y1', borderColor:cEmerald, backgroundColor:'rgba(16,185,129,.18)', fill:true, tension:.35, borderWidth:3, pointRadius:2 }
]
},
options:{
plugins:{ legend:{ position:'bottom', labels:{ color:'#cbd5e1' } } },
scales:{
x:{ ticks:{ color:axisColor() }, grid:{ color:gridColor(.15) } },
y1:{ position:'left', ticks:{ color:axisColor(), callback:v=>v+'%' }, grid:{ color:gridColor(.12) } },
y2:{ position:'right', ticks:{ color:axisColor() }, grid:{ drawOnChartArea:false } }
}
}
}) : null;
/* STAGE SEPT 2024 */
const septConsumerEl = document.getElementById('septConsumerChart');
const septCenturionEl = document.getElementById('septCenturionChart');
const chartSeptConsumer = septConsumerEl && window.Chart ? new Chart(septConsumerEl, {
type:'bar',
data:{
labels:['Austria','Germany','Sep. 2nd 2024 Overall'],
datasets:[
{ label:'HR CM volume', data:[575,5070,5645], backgroundColor:'rgba(14,165,233,.65)', borderColor:cSky, borderWidth:1 },
{ label:'HR CM refreshed', data:[365,2823,3188], backgroundColor:'rgba(16,185,129,.65)', borderColor:cEmerald, borderWidth:1 },
{ label:'CMs suspended', data:[14,217,231], backgroundColor:'rgba(148,163,184,.45)', borderColor:cMuted, borderWidth:1 },
{ label:'HR CM KYC cancelled', data:[14,113,127], backgroundColor:'rgba(239,68,68,.45)', borderColor:'#ef4444', borderWidth:1 }
]
},
options:{
plugins:{ legend:{ position:'bottom', labels:{ color:'#cbd5e1' } }, tooltip:{ mode:'index', intersect:false } },
scales:{ x:{ stacked:true, ticks:{ color:axisColor() }, grid:{ color:gridColor(.15) } },
y:{ stacked:true, beginAtZero:true, ticks:{ color:axisColor() }, grid:{ color:gridColor(.12) } } }
}
}) : null;
const chartSeptCenturion = septCenturionEl && window.Chart ? new Chart(septCenturionEl, {
type:'bar',
data:{
labels:['Austria','Germany','Overall'],
datasets:[
{ label:'HR Centurion volume', data:[130,385,515], backgroundColor:'rgba(14,165,233,.65)', borderColor:cSky, borderWidth:1 },
{ label:'Centurion refreshed', data:[90,241,331], backgroundColor:'rgba(16,185,129,.65)', borderColor:cEmerald, borderWidth:1 },
{ label:'Centurion suspended', data:[2,3,5], backgroundColor:'rgba(148,163,184,.45)', borderColor:cMuted, borderWidth:1 },
{ label:'Centurion KYC cancelled', data:[0,2,2], backgroundColor:'rgba(239,68,68,.45)', borderColor:'#ef4444', borderWidth:1 }
]
},
options:{
plugins:{ legend:{ position:'bottom', labels:{ color:'#cbd5e1' } }, tooltip:{ mode:'index', intersect:false } },
scales:{ x:{ stacked:true, ticks:{ color:axisColor() }, grid:{ color:gridColor(.15) } },
y:{ stacked:true, beginAtZero:true, ticks:{ color:axisColor() }, grid:{ color:gridColor(.12) } } }
}
}) : null;
/* STAGE MAY 2025 */
const mayConsumerEl = document.getElementById('mayConsumerChart');
const mayCenturionEl = document.getElementById('mayCenturionChart');
function stackedBar(el, labels, sets){
return new Chart(el, {
type:'bar',
data:{ labels, datasets:sets },
options:{
plugins:{ legend:{ position:'bottom', labels:{ color:'#cbd5e1' } }, tooltip:{ mode:'index', intersect:false } },
scales:{ x:{ stacked:true, ticks:{ color:axisColor() }, grid:{ color:gridColor(.15) } },
y:{ stacked:true, beginAtZero:true, ticks:{ color:axisColor() }, grid:{ color:gridColor(.12) } } }
}
});
}
const chartMayConsumer = mayConsumerEl && window.Chart ? stackedBar(
mayConsumerEl,
['Austria','Germany','Mai 20th 2025 Overall'],
[
{ label:'HR CM volume', data:[480,3216,3696], backgroundColor:'rgba(14,165,233,.65)', borderColor:cSky, borderWidth:1 },
{ label:'HR CM refreshed', data:[318,2612,2930], backgroundColor:'rgba(16,185,129,.65)', borderColor:cEmerald, borderWidth:1 },
{ label:'CMs suspended', data:[11,33,44], backgroundColor:'rgba(148,163,184,.45)', borderColor:cMuted, borderWidth:1 },
{ label:'HR CM KYC cancelled', data:[0,0,0], backgroundColor:'rgba(239,68,68,.45)', borderColor:'#ef4444', borderWidth:1 }
]
) : null;
const chartMayCenturion = mayCenturionEl && window.Chart ? stackedBar(
mayCenturionEl,
['Austria','Germany','Overall'],
[
{ label:'HR Centurion volume', data:[101,399,500], backgroundColor:'rgba(14,165,233,.65)', borderColor:cSky, borderWidth:1 },
{ label:'Centurion refreshed', data:[59,299,358], backgroundColor:'rgba(16,185,129,.65)', borderColor:cEmerald, borderWidth:1 },
{ label:'Centurion suspended', data:[0,0,0], backgroundColor:'rgba(148,163,184,.45)', borderColor:cMuted, borderWidth:1 },
{ label:'Centurion cancelled', data:[0,0,0], backgroundColor:'rgba(239,68,68,.45)', borderColor:'#ef4444', borderWidth:1 }
]
) : null;
/* STAGE AUG 2025 */
const augConsumerEl = document.getElementById('augConsumerChart');
const augCenturionEl = document.getElementById('augCenturionChart');
const chartAugConsumer = augConsumerEl && window.Chart ? stackedBar(
augConsumerEl,
['Austria','Germany','Aug 12th 2025 Overall'],
[
{ label:'HR CM volume', data:[515,3573,4088], backgroundColor:'rgba(14,165,233,.65)', borderColor:cSky, borderWidth:1 },
{ label:'HR CM refreshed', data:[377,3108,3485], backgroundColor:'rgba(16,185,129,.65)', borderColor:cEmerald, borderWidth:1 },
{ label:'CMs suspended', data:[18,59,77], backgroundColor:'rgba(148,163,184,.45)', borderColor:cMuted, borderWidth:1 },
{ label:'HR CM KYC cancelled', data:[0,1,1], backgroundColor:'rgba(239,68,68,.45)', borderColor:'#ef4444', borderWidth:1 }
]
) : null;
const chartAugCenturion = augCenturionEl && window.Chart ? stackedBar(
augCenturionEl,
['Austria','Germany','Overall'],
[
{ label:'HR Centurion volume', data:[114,465,579], backgroundColor:'rgba(14,165,233,.65)', borderColor:cSky, borderWidth:1 },
{ label:'Centurion refreshed', data:[72,400,472], backgroundColor:'rgba(16,185,129,.65)', borderColor:cEmerald, borderWidth:1 },
{ label:'Centurion suspended', data:[0,0,0], backgroundColor:'rgba(148,163,184,.45)', borderColor:cMuted, borderWidth:1 },
{ label:'Centurion cancelled', data:[0,0,0], backgroundColor:'rgba(239,68,68,.45)', borderColor:'#ef4444', borderWidth:1 }
]
) : null;
/* CSV listeners */
document.getElementById('csvSeptConsumerBtn')?.addEventListener('click', () => {
if (chartSeptConsumer) exportChartToCSV(chartSeptConsumer, 'sept-2024-consumer-visible.csv');
else exportTableToCSV(document.querySelector('#stage-sept-2024 table:nth-of-type(1)'), 'sept-2024-consumer.csv');
});
document.getElementById('csvSeptCenturionBtn')?.addEventListener('click', () => {
if (chartSeptCenturion) exportChartToCSV(chartSeptCenturion, 'sept-2024-centurion-visible.csv');
else exportTableToCSV(document.querySelector('#stage-sept-2024 table:nth-of-type(2)'), 'sept-2024-centurion.csv');
});
document.getElementById('csvMayConsumerBtn')?.addEventListener('click', () => {
if (chartMayConsumer) exportChartToCSV(chartMayConsumer, 'may-2025-consumer-visible.csv');
else exportTableToCSV(document.querySelector('#stage-may-2025 table:nth-of-type(1)'), 'may-2025-consumer.csv');
});
document.getElementById('csvMayCenturionBtn')?.addEventListener('click', () => {
if (chartMayCenturion) exportChartToCSV(chartMayCenturion, 'may-2025-centurion-visible.csv');
else exportTableToCSV(document.querySelector('#stage-may-2025 table:nth-of-type(2)'), 'may-2025-centurion.csv');
});
document.getElementById('csvAugConsumerBtn')?.addEventListener('click', () => {
if (chartAugConsumer) exportChartToCSV(chartAugConsumer, 'aug-2025-consumer-visible.csv');
else exportTableToCSV(document.querySelector('#stage-aug-2025 table:nth-of-type(1)'), 'aug-2025-consumer.csv');
});
document.getElementById('csvAugCenturionBtn')?.addEventListener('click', () => {
if (chartAugCenturion) exportChartToCSV(chartAugCenturion, 'aug-2025-centurion-visible.csv');
else exportTableToCSV(document.querySelector('#stage-aug-2025 table:nth-of-type(2)'), 'aug-2025-centurion.csv');
});
/* ====== Year-End dropdown (abrir/cerrar) ====== */
const yearDD = document.getElementById('yearDropdown');
const yearBtn = document.getElementById('yearBtn');
function setYearExpanded(on) { yearBtn.setAttribute('aria-expanded', String(on)); }
yearBtn?.addEventListener('click', (e) => {
e.stopPropagation();
const open = yearBtn.getAttribute('aria-expanded') !== 'true';
setYearExpanded(open);
});
document.addEventListener('click', (e) => { if (yearDD && !yearDD.contains(e.target)) setYearExpanded(false); });
document.addEventListener('keydown', (e) => { if (e.key === 'Escape') setYearExpanded(false); });
/* ====== Incluir el nuevo stage en el ciclo de mostrar/ocultar ====== */
const sYear = document.getElementById('stage-year-end');
const bYearOverview = document.getElementById('btnYearOverview');
function hideAllStagesExtended() {
[sSept, sMay, sAug, sYear].forEach(sec => { if (sec) sec.style.display = 'none'; });
[bSept, bMay, bAug, bYearOverview].forEach(b => { if (b) b?.setAttribute('aria-expanded','false'); });
}
function openYearStage() {
hideAllStagesExtended();
if (sYear) {
sYear.style.display = '';
window.scrollTo({ top: sYear.offsetTop - 16, behavior: 'smooth' });
}
}
bYearOverview?.addEventListener('click', () => {
openYearStage();
bYearOverview.setAttribute('aria-expanded', 'true');
renderYearView('overview');
setYearExpanded(false);
});
/* ====== Dataset (CSV) — puntos decimales para % ====== */
const yearCsv = `date,total contact,germany,austria,credit_cancelled,successful,not_success,other,success_ob,success_month
FEB 18,15,14,1,4,4,7,0,36.36,36.36
MARCH 5,43,40,3,7,14,22,0,38.89,
MARCH 21,46,43,3,6,12,17,0, 30.00,
MARCH 28,50,43,7,5,25,20,0,55.56,41.49
APRIL 14,25,23,2,7,9,6,3,50.00,
APRIL 24,40,34,6,0,22,18,0,55.00,52.50
MAY 08,54,41,13,1,29,21,3,54.72,
MAY 15,22,19,3,4,8,10,0,44.44,
MAY 23,69,63,6,4,47,17,1,72.31, 57.16
JUNE 1,63,55,8,0,44,18,1,69.84,
JUNE 06,16,16,0,0,8,7,1,50.00,
JUNE 15,82,74,8,0,61,20,1,74.39,
JUNE 23,57,53,4,2,40,14,0,72.73,66.74
JULY 07,77,69,8,0,51,19,7,66.23,
JULY 14,54,49,5,0,36,13,5,66.67,
JULY 21,24,18,6,0,13,7,3,54.17,
JULY 28,48,46,2,0,32,16,0,66.67,63.43
AUGUST 4,42,39,3,1,27,13,1,65.85,
AUGUST 11,16,14,1,1,9,6,0,60.00,
AUGUST 18,57,53,4,0,31,23,3,54.39,
AUGUST 25,26,26,0,1,16,1,8,64.00,61.07
SEP 8,30,30,0,2,17,11,0,60.71,
SEP 23,35,32,3,0,23,11,1,69.70,
SEP 29,35,35,0,1,21,13,0,63.64,64.69
OCT 6,39,35,4,0,23,16,0,62.16,
OCT 13,50,47,3,2,36,14,0,72.00,
OCT 20,34,31,3,0,21,13,0,63.64,
OCT 27,30,28,2,0,22,9,0,73.33,68.53
NOV 4,24,23,1,0,14,10,0,63.64,
NOV 10,33,30,3,0,20,13,0,60.61,60.61`;
function parseCsv(str) {
  const lines = str.trim().split(/\r?\n/);
  const headers = lines.shift().split(',').map(h => h.trim());
  return lines.map(line => {
    const cols = line.split(',').map(c => c.trim());
    const o = {};
    headers.forEach((h, i) => {
      o[h] = cols[i] !== undefined ? cols[i] : '';
    });
    return o;
  });
}
const yearRows = parseCsv(yearCsv);
function monthKeyFromBatch(s) {
  const t = (s || '').toLowerCase();
  if (t.includes('feb')) return 'Feb';
  if (t.includes('mar')) return 'Mar';
  if (t.includes('abr') || t.includes('apr')) return 'Apr';
  if (t.includes('may') || t.includes('may')) return 'May';
  if (t.includes('jun')) return 'Jun';
  if (t.includes('jul')) return 'Jul';
  if (t.includes('aug') || t.includes('ago')) return 'Aug';
  if (t.includes('sep')) return 'Sep';
  if (t.includes('oct') || t.includes('oct')) return 'Oct';
  if (t.includes('nov')) return 'Nov';
  if (t.includes('dec')) return 'Dec';
  return 'Other';
}
function renderTable(rows, caption, contextLabel) {
  const tbody = document.getElementById('yearTableBody');
  const cap = document.getElementById('yearTableCaption');
  const ctx = document.getElementById('yearContextLabel');
  if (!tbody) return;
  tbody.innerHTML = '';
  rows.forEach(r => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
<td>${r.date}</td>
<td>${r["total contact"]}</td>
<td>${r.germany}</td>
<td>${r.austria}</td>
<td>${r.credit_cancelled}</td>
<td>${r.successful}</td>
<td>${r.not_success}</td>
<td>${r.other || '0'}</td>
<td>${r.success_ob || ''}</td>
<td>${r.success_month || ''}</td>
`;
    tbody.appendChild(tr);
  });
  if (cap) cap.textContent = caption || 'Outbound Calls';
  if (ctx) ctx.textContent = contextLabel ? `• ${contextLabel}` : '';
}
let chartYear = null;
function renderChart(rows) {
  const el = document.getElementById('yearChart');
  if (!el || !window.Chart) return;
  if (chartYear) { chartYear.destroy(); chartYear = null; }
   const labels = rows.map(r => r.date);
  const success = rows.map(r => Number(r.successful || 0));
  const notSuccess = rows.map(r => Number(r.not_success || 0));
  const rate = rows.map(r => {
    const v = String(r.success_ob || '').replace(',', '.');
    const n = parseFloat(v);
    return isNaN(n) ? null : n;
  });
  const creditCancelled = rows.map(r => Number(r.credit_cancelled || 0));
  const other = rows.map(r => Number(r.other || 0));
  chartYear = new Chart(el, {
    type: 'bar',
    data: {
      labels,
      datasets: [
        { type:'bar', label:'Credit active, card cancelled', data:creditCancelled, backgroundColor:'rgba(239,68,68,.45)', borderColor:'#ef4444', borderWidth:1, stack:'s' },
        { type:'bar', label:'Successful - incl. Calls, forwarded for link, promised to do it', data:success, backgroundColor:'rgba(16,185,129,.65)', borderColor:'#10b981', borderWidth:1, stack:'s' },
        { type:'bar', label:'Not successful - no answer, left message', data:notSuccess, backgroundColor:'rgba(245,158,11,.65)', borderColor:'#f59e0b', borderWidth:1, stack:'s' },
        { type:'bar', label:'Other – (does not want to do the refresh ', data:other, backgroundColor:'rgba(253,186,116,.45)', borderColor:'#fdba74', borderWidth:1, stack:'s' },
        { type:'line', label:'Success rate OB %', data:rate, yAxisID:'y2', borderColor:cIndigo, backgroundColor:'rgba(99,102,241,.18)', fill:false, tension:.35, borderWidth:3, pointRadius:2 }
      ]
    },
    options: {
      plugins: { legend:{ position:'bottom', labels:{ color:'#cbd5e1' } }, tooltip:{ mode:'index', intersect:false } },
      scales: {
        x: { ticks:{ color:axisColor() }, grid:{ color:gridColor(.15) } },
        y: { beginAtZero:true, ticks:{ color:axisColor() }, grid:{ color:gridColor(.12) } },
        y2: { position:'right', ticks:{ color:axisColor(), callback:v => v + '%' }, grid:{ drawOnChartArea:false } }
      }
    }
  });
}
const monthOrder = ['Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec','Other'];
function buildMonthlyAgg(rows) {
  const map = {};
  rows.forEach(r => {
    const m = monthKeyFromBatch(r.date);
    if (!map[m]) map[m] = { successSum: 0, successRateVals: [], attemptSum: 0 };
    map[m].successSum += Number(r.successful || 0);
    map[m].attemptSum += Number(r["total contact"] || 0) - Number(r.credit_cancelled || 0);
    const raw = String(r.success_month || '').replace(',', '.').trim();
    const v = parseFloat(raw);
    if (!isNaN(v)) map[m].successRateVals.push(v);
  });
  const labels = Object.keys(map).sort((a,b) => monthOrder.indexOf(a)-monthOrder.indexOf(b));
  const successPercent = labels.map(m => {
    const as = map[m].attemptSum;
    return as > 0 ? (map[m].successSum / as) * 100 : null;
  });
  const successRate = labels.map(m => {
    const arr = map[m].successRateVals;
    if (!arr.length) return null;
    const avg = arr.reduce((s,x)=>s+x,0)/arr.length;
    return Math.round(avg*100)/100;
  });
  return { labels, successPercent, successRate };
}
let chartYearMonthly = null;
let chartYearGA = null;
function renderMonthlySummary(rows) {
  const el = document.getElementById('yearChartMonthly');
  if (!el || !window.Chart || rows.length === 0) return;
  if (chartYearMonthly) { chartYearMonthly.destroy(); chartYearMonthly = null; }
  const agg = buildMonthlyAgg(rows);
  chartYearMonthly = new Chart(el, {
    type: 'bar',
    data: {
      labels: agg.labels,
      datasets: [
        { type: 'bar', label: 'Successful % (monthly total)', data: agg.successPercent, backgroundColor: 'rgba(16,185,129,.65)', borderColor: cEmerald, borderWidth: 1 },
        { type: 'line', label: 'Success rate by month % (avg)', data: agg.successRate, borderColor: cIndigo, backgroundColor: 'rgba(99,102,241,.18)', fill: false, tension: .35, borderWidth: 3, pointRadius: 2 }
      ]
    },
    options: {
      plugins: { legend:{ position:'bottom', labels:{ color:'#cbd5e1' } }, tooltip:{ mode:'index', intersect:false } },
      scales: {
        x: { ticks:{ color: axisColor() }, grid:{ color: gridColor(.15) } },
        y: { beginAtZero:true, ticks:{ color: axisColor(), callback:v => v + '%' }, grid:{ color:gridColor(.12) } }
      }
    }
  });
}
function renderGAByBatch(rows) {
  const el = document.getElementById('yearChartGA');
  if (!el || !window.Chart) return;
  if (chartYearGA) { chartYearGA.destroy(); chartYearGA = null; }
  const labels = rows.map(r => r.date);
  const ger = rows.map(r => Number(r.germany || 0));
  const aut = rows.map(r => Number(r.austria || 0));
  chartYearGA = new Chart(el, {
    type: 'bar',
    data: {
      labels,
      datasets: [
        { label:'Germany', data:ger, backgroundColor:'rgba(14,165,233,.65)', borderColor:cSky, borderWidth:1, stack:'geo' },
        { label:'Austria', data:aut, backgroundColor:'rgba(99,102,241,.45)', borderColor:cIndigo, borderWidth:1, stack:'geo' }
      ]
    },
    options: {
      plugins: { legend:{ position:'bottom', labels:{ color:'#cbd5e1' } }, tooltip:{ mode:'index', intersect:false } },
      scales: {
        x: { ticks:{ color: axisColor() }, grid:{ color:gridColor(.15) } },
        y: { beginAtZero:true, ticks:{ color: axisColor() }, grid:{ color:gridColor(.12) } }
      }
    }
  });
}
function renderYearView(kind, period) {
  openYearStage();
  let filtered = yearRows;
  let title = 'Overview 2025';
  if (period === 'Q1') {
    filtered = yearRows.filter(r => ['Feb','Mar','Apr','May','Jun'].includes(monthKeyFromBatch(r.date)));
    title = 'Q1 2025 (Feb-Jun)';
  } else if (period === 'Q2') {
    filtered = yearRows.filter(r => ['Jul','Aug','Sep','Oct','Nov','Dec'].includes(monthKeyFromBatch(r.date)));
    title = 'Q2 2025 (Jul-Dec)';
  }
  renderTable(filtered, `Outbound Calls — ${title}`, title);
  renderChart(filtered);
  renderMonthlySummary(filtered);
  renderGAByBatch(filtered);
}
document.querySelectorAll('#yearMenu .menu-item[data-year-period]').forEach(btn => {
  btn.addEventListener('click', () => {
    const period = btn.getAttribute('data-year-period');
    renderYearView('period', period);
    setYearExpanded(false);
  });
});
document.getElementById('csvYearBtn')?.addEventListener('click', () => {
  if (chartYear) exportChartToCSV(chartYear, 'year-end-visible.csv');
  else exportTableToCSV(document.getElementById('yearTable'), 'year-end.csv');
});
document.getElementById('csvYearMonthlyBtn')?.addEventListener('click', () => {
  if (chartYearMonthly) exportChartToCSV(chartYearMonthly, 'year-overview-monthly-visible.csv');
});
document.getElementById('csvYearGABtn')?.addEventListener('click', () => {
  if (chartYearGA) exportChartToCSV(chartYearGA, 'year-month-geo-visible.csv');
});
});
</script>
</body>
</html>
